# Two-Time Pad

O intuito do ataque é obter mais de uma mensagem encriptografada com a mesma chave.

## Exemplo 
C1 ^ C2 =
(m1 ^ k) ^ (m2 ^ k) =
(m1 ^ K) ^ (k ^ m2) =
m1 ^ m2













Tabela verdade:

    |XOR| 0 | 1 |
    | 0 | 0 | 1 |
    | 1 | 1 | 0 |

A principal diferença entre o E e OU é que no XOR não admite (Verdadeiro, Verdadeiro)

## Criptografar

### Exemplo
M = "JAVA"
K = "BCFF"

Onde:
J ^ B = 74 ^ 66 = 8
A ^ C = 65 ^ 67 = 2
V ^ F = 86 ^ 70 = 16
A ^ F = 65 ^ 70 = 7

XOR bit-a-bit

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    | 74 |  1 |  0 |  0 | 1 | 0 | 1 | 0 |
    | 66 |  1 |  0 |  0 | 0 | 0 | 1 | 0 |
    |    |  0 |  0 |  0 | 1 | 0 | 0 | 0 |

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    | 65 |  1 |  0 |  0 | 0 | 0 | 0 | 1 |
    | 67 |  1 |  0 |  0 | 0 | 0 | 1 | 1 |
    |    |  0 |  0 |  0 | 0 | 0 | 1 | 0 |

E("BCFF, "JAVA") = 08021007

### Exercício
Encripte "FATEC" com a chave "!@ABB" usando OTP.
M = "FATEC"
K = "!@ABB" 

F ^ ! = 70 ^ 33 = 64+32+4+2+1 = 103

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    | 70 |  1 |  0 |  0 | 0 | 1 | 1 | 0 |
    | 33 |  0 |  1 |  0 | 0 | 0 | 0 | 1 |
    |    |  1 |  1 |  0 | 0 | 1 | 1 | 1 |

A ^ @ = 65 ^ 64 = 1

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    | 65 |  1 |  0 |  0 | 0 | 0 | 0 | 1 |
    | 64 |  1 |  0 |  0 | 0 | 0 | 0 | 0 |
    |    |  0 |  0 |  0 | 0 | 0 | 0 | 1 |
 
T ^ A = 84 ^ 65 = 16+4+1 = 21

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    | 84 |  1 |  0 |  1 | 0 | 1 | 0 | 0 |
    | 65 |  1 |  0 |  0 | 0 | 0 | 0 | 1 |
    |    |  0 |  0 |  1 | 0 | 1 | 0 | 1 |
    
E ^ B = 69 ^ 66 = 4+2+1 = 7

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    | 69 |  1 |  0 |  0 | 0 | 1 | 0 | 1 |
    | 66 |  1 |  0 |  0 | 0 | 0 | 1 | 0 |
    |    |  0 |  0 |  0 | 0 | 1 | 1 | 1 |

C ^ B = 67 ^ 66 = 1

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    | 67 |  1 |  0 |  0 | 0 | 0 | 1 | 1 |
    | 66 |  1 |  0 |  0 | 0 | 0 | 1 | 0 |
    |    |  0 |  0 |  0 | 0 | 0 | 0 | 1 |
    
E("!@ABB, "FATEC") = 6701150701

## Descriptografar
D(K,E(K,M)) = D(K,C), onde, C = K^M

    |103 |  1 |  1 |  0 | 0 | 1 | 1 | 1 | 
    |1   |  0 |  0 |  0 | 0 | 0 | 0 | 1 | 
    |21  |  0 |  0 |  1 | 0 | 1 | 0 | 1 |    
    |7   |  0 |  0 |  0 | 0 | 1 | 1 | 1 |   
    |1   |  0 |  0 |  0 | 0 | 0 | 0 | 1 |

XOR = F

    |  ^ | 64 | 32 | 16 | 8 | 4 | 2 | 1 |
    |103 |  1 |  1 |  0 | 0 | 1 | 1 | 1 |
    | 33 |  0 |  1 |  0 | 0 | 0 | 0 | 1 |    
    |    |  1 |  0 |  0 | 0 | 1 | 1 | 0 |